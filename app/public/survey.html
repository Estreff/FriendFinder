<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Friend Finder</title>
    <!-- Favicon -->
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <!-- Awesome Fonts -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

</head>
<body>
    <div class="wrapper"  style"margin: 20px">
        <div class="container">
            <div>
                <h1>Survey Questions</h1>
                
            </div>
            <div>
                <hr style="border: 2px solid gray">
                <form action="" method="post">
                    <h2>About You</h2>

                    <form role="form" class="form-group" id="friendFinder">
                                                            
                        <h3>
                            <label for="name">Name: <span style="color:red; font-size:16px">(Required)</span></label>
                            <input id="name-input" type="text" class="form-control" placeholder="Full Name" required>
                        </h3>

                        <h3>
                            <label for="image">Add link to Photo Image: <span style="color:red; font-size:16px">(Required)</span></label>
                            <input id="image-input" type="text" class="form-control" placeholder="http://putyourimagefilehere.com" required>
                        </h3>

                        <hr style="border: 2px solid gray">

                        <h2><strong>Question 1</strong></h2>
                        <h3>Star Wars I (The Phantom Menace) is the best movie!</h3>
                            <select placecholder="Select an Option" class="form-control custom-select" style="width:auto" id="question1">
                                <option value="">Select an Option</option>
                                <option value="1">1 (Strongly Disagree)</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5 (Strongly Agree)</option>
                            </select>

                        <h2><strong>Question 2</strong></h2>
                        <h3>Star Wars II (Attack of the Clones) is the best movie!</h3>
                            <select placecholder="Select an Option" class="form-control custom-select" style="width:auto" id="question2">
                                <option value="">Select an Option</option>
                                <option value="1">1 (Strongly Disagree)</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5 (Strongly Agree)</option>
                            </select>

                        <h2><strong>Question 3</strong></h2>
                        <h3>Star Wars III (Revenge of the Sith) is the best movie!</h3>
                            <select placecholder="Select an Option" class="form-control custom-select" style="width:auto" id="question3">
                                <option value="">Select an Option</option>
                                <option value="1">1 (Strongly Disagree)</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5 (Strongly Agree)</option>
                            </select>

                        <h2><strong>Question 4</strong></h2>
                        <h3>Star Wars IV (A New Hope) is the best movie!</h3>
                            <select placecholder="Select an Option" class="form-control custom-select" style="width:auto" id="question4">
                                <option value="">Select an Option</option>
                                <option value="1">1 (Strongly Disagree)</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5 (Strongly Agree)</option>
                            </select>

                        <h2><strong>Question 5</strong></h2>
                        <h3>Star Wars V(The Empire Strikes Back) is the best movie!</h3>
                            <select placecholder="Select an Option" class="form-control custom-select" style="width:auto" id="question5">
                                <option value="">Select an Option</option>
                                <option value="1">1 (Strongly Disagree)</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5 (Strongly Agree)</option>
                            </select>
                        
                        <h2><strong>Question 6</strong></h2>
                        <h3>Star Wars VI (Return of the Jedi) is the best movie!</h3>
                            <select placecholder="Select an Option" class="form-control custom-select" style="width:auto" id="question6">
                                <option value="">Select an Option</option>
                                <option value="1">1 (Strongly Disagree)</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5 (Strongly Agree)</option>
                            </select>

                        <h2><strong>Question 7</strong></h2>
                        <h3>Star Wars VII (The Force Awakens) is the best movie!</h3>
                            <select placecholder="Select an Option" class="form-control custom-select" style="width:auto" id="question7">
                                <option value="">Select an Option</option>
                                <option value="1">1 (Strongly Disagree)</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5 (Strongly Agree)</option>
                            </select>

                        <h2><strong>Question 8</strong></h2>
                        <h3>I expect Star Wars VIII (The Last Jedi) to be the best movie!</h3>
                            <select placecholder="Select an Option" class="form-control custom-select" style="width:auto" id="question8">
                                <option value="">Select an Option</option>
                                <option value="1">1 (Strongly Disagree)</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5 (Strongly Agree)</option>
                            </select>
                        
                        <h2><strong>Question 9</strong></h2>
                        <h3>I expect Star Wars IX to be the best one in the series!</h3>
                            <select placecholder="Select an Option" class="form-control custom-select" style="width:auto" id="question9">
                                <option value="">Select an Option</option>
                                <option value="1">1 (Strongly Disagree)</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5 (Strongly Agree)</option>
                            </select>

                        <h2><strong>Question 10</strong></h2>
                        <h3>I think that Jar Jar Binks in the last Sith Lord!</h3>
                            <select placecholder="Select an Option" class="form-control custom-select" style="width:auto" id="question10">
                                <option value="">Select an Option</option>
                                <option value="1">1 (Strongly Disagree)</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5 (Strongly Agree)</option>
                            </select>
                </form>

                <button style="margin: 20px 0px" type="submit" class="btn btn-primary btn-lg btn-block" id="submit" data-toggle="modal" data-target="#friendMatch"><i class="fa fa-check-circle"></i> Submit</button>
                <hr style="border: 2px solid gray">
            </div>
            <div style="margin-top:20px;">
                <a href="/" style=" margin-right: 20px"><button class="btn btn-info btn-lg" style="margin-bottom: 20px"><span class=" fa fa-home"></span> Go to Home Page</button></a>
                <a href="/api/friends">API Friends List</a> | <a href="https:github.com/estreff/FriendFinder">Git Hub Repository</a>
            </div>

        </div>
        <!-- Matched Friend Modal -->
<div class="modal" id="friendMatch">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
                <div class="modal-header">
                  <h2 class="modal-title"><span class="fa fa-street-view" id="modalTitle"> Best Friend Found</span></h2>
                </div>
                <div class="modal-body">
                    <div id="friendName" style="font-size: 24px; font-weight: bold; margin: 20px;"></div>
                    <div>
                        <img id="friendImage" src="" alt="">
                    </div>
                    <div id="friendScore" style="font-size: 18px; font-weight: bold; margin: 20px;"></div>
                </div>
                <div class="modal-footer">
                  <button type="submit" class="btn btn-success" id="friendConfirm" data-dismiss="modal">Awesome, a New Friend!!</button>
              </div>
          </div>
        </div>
  </div>
    </div>
    <script src="https://code.jquery.com/jquery.js"></script> 
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript">

    // Submit Name, Image and Answers on 'Submit' click
        $("#submit").on("click", function(event) {
            event.preventDefault();
            // create new friend object
            var newFriend = {
                name: $("#name-input").val().trim(),
                image: $("#image-input").val().trim(),
                scores: [
                    $("#question1").val().trim(), 
                    $("#question2").val().trim(),
                    $("#question3").val().trim(),
                    $("#question4").val().trim(),
                    $("#question5").val().trim(),
                    $("#question6").val().trim(),
                    $("#question7").val().trim(),
                    $("#question8").val().trim(),
                    $("#question9").val().trim(),
                    $("#question10").val().trim()
                ]
            };

            if (newFriend.name === "" || newFriend.image === "" || newFriend.scores[0] === "" || newFriend.scores[1] === "" || newFriend.scores[2] === "" || newFriend.scores[3] === "" || newFriend.scores[4] === "" || newFriend.scores[5] === "" || newFriend.scores[6] === "" || newFriend.scores[7] === "" || newFriend.scores[8] === "" || newFriend.scores[9] === "") {
                $('#friendName').text('Please make sure all fields have been filled!!');
                $('#modalTitle').text(' Best Friend NOT Found');
                $('#friendConfirm').text('Enter All Fields');
                $('#friendConfirm').removeClass('btn-success');
                $('#friendConfirm').addClass('btn-danger');
                $('#friendImage').attr('src', "");
                $('#friendScore').text("");

	        } else {
                $.post("/api/friends", newFriend)
                .done(function(data) {
                    console.log(data);
                        $("#name-input").val("")
                        $("#image-input").val("")
                        $("#question1").val("") 
                        $("#question2").val("")
                        $("#question3").val("")
                        $("#question4").val("")
                        $("#question5").val("")
                        $("#question6").val("")
                        $("#question7").val("")
                        $("#question8").val("")
                        $("#question9").val("")
                        $("#question10").val("")
                });  

                $('#modalTitle').text(' Best Friend Found');
                $('#friendConfirm').text('Awesome, a New Friend!!');
                $('#friendConfirm').addClass('btn-success');
                $('#friendConfirm').removeClass('btn-danger');

                
                $.get("/api/friends", function(data) {
                    
                    var compareFriends = [];
                    var currentFriend = data[data.length-1].scores;
                    var difference = [];
                    var count = 0;
                    
                    for (var i = 0; i < data.length-1; i++) {
                        var score = data[i].scores;
                        for(var j = 0; j < score.length; j++) {
                            var diff = Math.abs(currentFriend[j] - score[j]);
                            count += diff;                        
                        }
                        difference.push(count);
                        count = 0;
                    }
                    var index = difference.indexOf(Math.min.apply(null,difference));

                    $('#friendName').text(data[index].name);
                    $('#friendImage').attr('src',data[index].image);
                    $('#friendScore').text(`You were only seperated by ${difference[index]} points!!`);
                });
            }
        cd });
        
    </script>
    
</body>
</html>